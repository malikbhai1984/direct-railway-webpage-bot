



<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üß† SYNDICATE v18.1 LIVE</title>
  <style>
    :root{--primary:#00d4aa;--secondary:#ffd700;--bg-dark:#0f0f23;--bg-card:rgba(255,255,255,0.06);}
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:system-ui,sans-serif;background:linear-gradient(135deg,var(--bg-dark),#1a1a2e);color:#fff;min-height:100vh;}
    .top-notification{position:fixed;top:0;left:0;right:0;background:rgba(0,0,0,0.98);z-index:2000;max-height:400px;overflow-y:auto;border-bottom:3px solid var(--secondary);}
    .notification-header{padding:15px;background:linear-gradient(90deg,var(--secondary),#9c66ff);text-align:center;font-weight:900;}
    .notification-item{padding:15px;border-bottom:1px solid rgba(255,215,0,0.3);display:flex;gap:10px;}
    .notification-item.new{animation:blink 1s infinite;}
    @keyframes blink{0%,100%{background:rgba(255,215,0,0.2);}50%{background:rgba(255,165,0,0.4);}}
    .main-content{padding-top:420px;padding:20px;}
    .header{text-align:center;padding:30px;background:linear-gradient(135deg,#9c66ff,rgba(156,102,255,0.4));border-radius:20px;margin-bottom:20px;}
    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:15px;margin:20px 0;}
    .stat-card{background:var(--bg-card);padding:15px;border-radius:15px;text-align:center;}
    .stat-value{font-size:2em;font-weight:900;color:var(--secondary);}
    .matches{display:grid;gap:15px;max-height:65vh;overflow-y:auto;}
    .match{background:var(--bg-card);padding:20px;border-radius:20px;}
    .league{font-size:1.2em;font-weight:900;color:var(--primary);}
    .score{font-size:2.5em;font-weight:900;color:var(--secondary);text-align:center;}
    .team-odds{display:flex;justify-content:space-around;margin:15px 0;}
    .odds-box{text-align:center;}
    .odds-value{font-size:2em;font-weight:900;color:var(--secondary);}
    .main-markets-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:8px;}
    .market-card{padding:12px;background:rgba(255,255,255,0.08);border-radius:10px;text-align:center;font-weight:700;}
    .market-card.high{animation:pulse 1s infinite;border:2px solid var(--secondary);background:rgba(255,215,0,0.2);}
    .api-status{position:fixed;top:10px;right:10px;background:rgba(0,0,0,0.8);padding:15px;border-radius:10px;font-size:14px;}
  </style>
</head>
<body>
  <div class="api-status" id="status">üîÑ Connecting...</div>
  
  <div class="top-notification" id="notifications">
    <div class="notification-header">üö® TOP ALERTS (70%+)</div>
  </div>
  
  <div class="main-content">
    <div class="header">
      <h1>üß† SYNDICATE v18.1 LIVE</h1>
      <p>Poisson ML | SofaScore API | 7s Refresh | üáµüá∞ PKT</p>
    </div>
    
    <div class="stats-grid" id="stats"></div>
    <div class="matches" id="matches">Loading live matches...</div>
  </div>

  <script>
    const MAIN_MARKETS = ['O0.5','O1.5','O2.5','O3.5','O4.5','O5.5'];
    
    async function loadData() {
      try {
        document.getElementById('status').textContent = 'üîÑ Fetching...';
        const res = await fetch('/api/matches');
        const data = await res.json();
        
        // ‚úÖ COMPLETE .map() FUNCTIONS (NO ERRORS)
        document.getElementById('notifications').innerHTML = `
          <div class="notification-header">üö® TOP ALERTS (${data.notifications?.length || 0}/25)</div>
          ${data.notifications?.map(notif => `
            <div class="notification-item ${notif.isNew ? 'new' : ''}">
              <div>${notif.league}</div>
              <div>${notif.teams} (${notif.score}) ${notif.minute}'</div>
              <div>üî• ${notif.bestMarket} ${notif.bestConf}%</div>
              <div>üè†${notif.homeWin}% ü§ù${notif.drawChance}% ‚úàÔ∏è${notif.awayWin}%</div>
            </div>
          `).join('') || '<div style="padding:20px;color:#888;">No alerts</div>'}
        `;
        
        document.getElementById('stats').innerHTML = `
          <div class="stat-card"><div class="stat-value">${data.notifications?.length || 0}</div>TOP</div>
          <div class="stat-card"><div class="stat-value">${data.live_count || 0}</div>LIVE</div>
          <div class="stat-card"><div class="stat-value">${data.total_scanned || 0}</div>SCANNED</div>
          <div class="stat-card"><div class="stat-value">v18.1</div>LIVE</div>
        `;
        
        document.getElementById('matches').innerHTML = data.live?.map(match => {
          const analysis = match.analysis;
          const totalGoals = match.home_score + match.away_score;
          const dynamic = analysis.dynamicWinDraw;
          
          return `
            <div class="match">
              <div class="league">${match.league}</div>
              <div class="score">${match.home_score}-${match.away_score}</div>
              <div>${match.home_team} vs ${match.away_team}</div>
              <div>LIVE ${match.minute}' | üáµüá∞ ${match.pk_time}</div>
              <div class="team-odds">
                <div class="odds-box"><div>${dynamic.homeWin}%</div><div>HOME</div></div>
                <div class="odds-box"><div>${dynamic.draw}%</div><div>DRAW</div></div>
                <div class="odds-box"><div>${dynamic.awayWin}%</div><div>AWAY</div></div>
              </div>
              <div style="display:grid;grid-template-columns:repeat(6,1fr);gap:8px;margin-top:15px;">
                ${MAIN_MARKETS.map(market => {
                  const conf = analysis.activeMarkets[market];
                  const line = parseFloat(market.slice(1));
                  if (totalGoals >= line) return `<div class="market-card">‚úì</div>`;
                  return conf ? `<div class="market-card ${conf>=70?'high':''}">${conf}%</div>` : `<div class="market-card">--</div>`;
                }).join('')}
              </div>
            </div>
          `;
        }).join('') || '<div style="text-align:center;padding:50px;">No live matches</div>';
        
        document.getElementById('status').textContent = `‚úÖ LIVE | ${data.live_count || 0} matches`;
      } catch(e) {
        document.getElementById('status').textContent = '‚ùå node server.js';
        document.getElementById('matches').innerHTML = '<div style="text-align:center;padding:50px;color:#ff6b6b;">Server Error<br>1. Save server.js<br>2. node server.js<br>3. Refresh</div>';
      }
    }
    
    // ‚úÖ 7s AUTO REFRESH (COMPLETE)
    setInterval(loadData, 7000);
    loadData();
  </script>
</body>
</html>
