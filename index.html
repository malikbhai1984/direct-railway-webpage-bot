



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Live Football Predictions</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
    h1 { color: #333; }
    .match { background: #fff; padding: 15px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .teams { font-weight: bold; font-size: 1.1em; }
    .prob { margin-top: 5px; }
    .strong { color: green; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Live Football Predictions</h1>
  <div id="matches"></div>

  <script>
    const matchesContainer = document.getElementById('matches');

    // Connect to SSE endpoint
    const evtSource = new EventSource('/events');

    evtSource.onmessage = function(event) {
      const data = JSON.parse(event.data);
      if (data.error) {
        matchesContainer.innerHTML = `<p style="color:red;">Error: ${data.error}</p>`;
        return;
      }

      const matches = data.matches;
      matchesContainer.innerHTML = '';

      matches.forEach(m => {
        const div = document.createElement('div');
        div.className = 'match';
        div.innerHTML = `
          <div class="teams">${m.home} vs ${m.away}</div>
          <div class="prob">Winner Probability: Home ${m.winnerProb.home}% | Draw ${m.winnerProb.draw}% | Away ${m.winnerProb.away}%</div>
          <div class="prob">BTTS: ${m.bttsProb}%</div>
          <div class="prob">Last 10 min goal: ${m.last10Prob}%</div>
          <div class="prob">xG: Home ${m.xG.home}, Away ${m.xG.away}, Total ${m.xG.total}</div>
          <div class="prob">Strong Markets: ${m.strongMarkets.map(s => `<span class="strong">${s.market} (${s.prob}%)</span>`).join(', ')}</div>
        `;
        matchesContainer.appendChild(div);
      });
    };

    evtSource.onerror = function(err) {
      console.error("SSE error:", err);
      matchesContainer.innerHTML = `<p style="color:red;">SSE connection lost. Trying to reconnect...</p>`;
    };
  </script>
</body>
</html>
